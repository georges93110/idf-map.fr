<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    html[data-app-ready="0"] {
      background:#0b0b0b;
    }
    html[data-app-ready="0"] body {
      opacity:0 !important;
      visibility:hidden !important;
      overflow:hidden !important;
    }
  </style>
  <script>
    (function setupAppReadyGate() {
      const root = document.documentElement;
      root.setAttribute("data-app-ready", "0");
      let done = false;
      function reveal() {
        if (done) return;
        done = true;
        root.setAttribute("data-app-ready", "1");
      }
      window.__setAppReady = function __setAppReady(options) {
        const cfg = options && typeof options === "object" ? options : {};
        const minFrames = Math.max(4, Number(cfg.minFrames) || 8);
        const stableFrames = Math.max(2, Number(cfg.stableFrames) || 3);
        const maxFrames = Math.max(minFrames + stableFrames, Number(cfg.maxFrames) || 28);
        let frameCount = 0;
        let stableCount = 0;
        let previousKey = "";
        const step = () => {
          frameCount += 1;
          let layoutKey = "";
          const body = document.body;
          if (body) {
            const rect = body.getBoundingClientRect();
            layoutKey = [
              Math.round(rect.width),
              Math.round(rect.height),
              document.documentElement.scrollWidth,
              document.documentElement.scrollHeight
            ].join("x");
          }
          stableCount = layoutKey && layoutKey === previousKey ? stableCount + 1 : 0;
          previousKey = layoutKey;
          const enoughFrames = frameCount >= minFrames;
          const visuallyStable = stableCount >= stableFrames;
          const frameBudgetExceeded = frameCount >= maxFrames;
          if ((!enoughFrames || !visuallyStable) && !frameBudgetExceeded) {
            requestAnimationFrame(step);
            return;
          }
          reveal();
        };
        const start = () => requestAnimationFrame(step);
        if (document.fonts && document.fonts.ready) {
          Promise.race([
            document.fonts.ready.catch(() => {}),
            new Promise((resolve) => setTimeout(resolve, 1200))
          ]).finally(start);
          return;
        }
        start();
      };
      window.addEventListener("pageshow", reveal, { once: true });
      window.setTimeout(reveal, 7000);
    })();
  </script>
  <title>Template</title>
  <link rel="icon" type="image/png" href="images/idf_logo_new.png"/>
</head>
<body data-bg-opacity="0.28" data-bg-overlay-top="0.72" data-bg-overlay-bottom="0.9">
  <script src="config/translations.js"></script>
  <script src="config/offsite-links.js"></script>
  <script src="config/site-nav.js"></script>
  <script src="config/shared-header.js"></script>
  <script>
    (function initTemplatePage() {
      function lang() {
        return String(document.documentElement.getAttribute("lang") || "fr").toLowerCase().slice(0, 2);
      }
      function t(key, fallback) {
        const i18n = window.I18N || {};
        const code = lang();
        const fromLang = i18n[code] && i18n[code][key];
        if (typeof fromLang === "string" && fromLang) return fromLang;
        const fromFr = i18n.fr && i18n.fr[key];
        if (typeof fromFr === "string" && fromFr) return fromFr;
        return fallback;
      }
      function render() {
        document.title = t("template_page_title", t("nav_page_test", "Template"));
      }
      render();
      new MutationObserver(render).observe(document.documentElement, {
        attributes: true,
        attributeFilter: ["lang"]
      });
    })();
  </script>
  <script>
    window.__setAppReady?.();
  </script>
</body>
</html>
